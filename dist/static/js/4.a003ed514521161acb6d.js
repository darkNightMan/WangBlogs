webpackJsonp([4],{RsQ1:function(e,t){},ebBp:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("pFYg"),r=a.n(o),i=a("Xxa5"),l=a.n(i),n=a("exGp"),s=a.n(n),p=a("Dd8w"),c=a.n(p),u=a("2CGT"),d=a("NYxO"),m={data:function(){return{crap:!1,previews:{},loading:!1,option:{fixed:!0,img:"",info:!0,outputSize:1,outputType:"png",canMoveBox:!0,autoCrop:!0,canScale:!0,centerBox:!0,fixedBox:!1,fixedNumber:[4,4]},fileName:"",downImg:"#",imgFile:"",uploadImgRelaPath:"",roleList:[],dialogVisible:!1,corpperImag:"",roleValidateForm:{nick_name:"",password:"",email:"",phone:"",avatar:"",role_id:[]}}},computed:c()({},Object(d.c)("user",["userInfo"])),created:function(){this.getroleList(),this.roleValidateForm=this.userInfo},methods:{updateuUser:function(){var e=this;return s()(l.a.mark(function t(){var a,o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.Req.put(u.a.updateUser,e.roleValidateForm);case 3:a=t.sent,o=a.code,r=a.msg,200===o?(e.$message({message:r,type:"success"}),e.dialogVisiblerole=!1):(e.dialogVisiblerole=!1,e.resetForm("roleValidateForm")),e.loading=!1;case 8:case"end":return t.stop()}},t,e)}))()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.updateuUser()})},getroleList:function(){var e=this;return s()(l.a.mark(function t(){var a,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Req.get(u.a.getAllRole);case 2:a=t.sent,o=a.data,200===a.code&&(e.roleList=o.roleList);case 6:case"end":return t.stop()}},t,e)}))()},realTime:function(e){this.previews=e;var t=this;this.$refs.cropper.getCropData(function(e){t.corpperImag=e})},uploadImg:function(e,t){var a=this,o=e.target.files[0];if(a.fileName=o.name,!/\.(gif|jpg|jpeg|png|bmp|GIF|JPG|PNG)$/.test(e.target.value))return alert("图片类型必须是.gif,jpeg,jpg,png,bmp中的一种"),!1;var i=new FileReader;i.onload=function(e){var o=void 0;o="object"===r()(e.target.result)?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,1===t?a.option.img=o:2===t&&(a.example2.img=o)},i.readAsArrayBuffer(o)},submitUpload:function(){var e=this;return s()(l.a.mark(function t(){var a,o,r,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=new FormData,o=e.base64URLtoFile(e.corpperImag),a.append("images",o,"csde_"+Date.parse(new Date)+".jpeg"),e.loading=!0,t.next=6,e.Req.upload(u.a.uploadImage,a,{headers:{"Content-Type":"multipart/form-data"}});case 6:r=t.sent,i=r.data,200===r.code&&(e.roleValidateForm.avatar=i.path),e.dialogVisible=!1,e.loading=!1;case 12:case"end":return t.stop()}},t,e)}))()},base64UrlToBlob:function(e){for(var t=e.split(","),a=t[0].match(/:(.*?);/)[1],o=atob(t[1]),r=o.length,i=new Uint8Array(r);r--;)i[r]=o.charCodeAt(r);return new Blob([i],{type:a})},base64URLtoFile:function(e,t){for(var a=e.split(","),o=a[0].match(/:(.*?);/)[1],r=atob(a[1]),i=r.length,l=new Uint8Array(i);i--;)l[i]=r.charCodeAt(i);return new File([l],t,{type:o})}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("个人信息")])]),e._v(" "),a("el-form",{ref:"roleValidateForm",staticClass:"demo-ruleForm",staticStyle:{width:"40%"},attrs:{model:e.roleValidateForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[a("div",{on:{click:function(t){e.dialogVisible=!0,e.option.img=e.roleValidateForm.avatar}}},[a("el-avatar",{attrs:{size:60,icon:"el-icon-user-solid",src:e.roleValidateForm.avatar}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"role_id",rules:[{required:!0,message:"角色名不能为空"}]}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.roleValidateForm.role_id,callback:function(t){e.$set(e.roleValidateForm,"role_id",t)},expression:"roleValidateForm.role_id"}},e._l(e.roleList,function(e){return a("el-option",{key:e.role_id,attrs:{label:e.role_name,value:e.role_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"nick_name",rules:[{required:!0,message:"用户名不能为空"}]}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.nick_name,callback:function(t){e.$set(e.roleValidateForm,"nick_name",t)},expression:"roleValidateForm.nick_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"phone",rules:[{required:!0,message:"电话名不能为空"}]}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.phone,callback:function(t){e.$set(e.roleValidateForm,"phone",t)},expression:"roleValidateForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password",rules:[{required:!0,message:"密码名不能为空"}]}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.password,callback:function(t){e.$set(e.roleValidateForm,"password",t)},expression:"roleValidateForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"email",prop:"email"}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.email,callback:function(t){e.$set(e.roleValidateForm,"email",t)},expression:"roleValidateForm.email"}})],1)],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"100px"},attrs:{type:"primary",size:"small",loading:e.loading},on:{click:function(t){return e.submitForm("roleValidateForm")}}},[e._v("保存")])],1),e._v(" "),a("el-dialog",{attrs:{title:"头像设置",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:13}},[a("div",{staticClass:"cropper"},[a("vueCropper",{ref:"cropper",attrs:{img:e.option.img,outputSize:e.option.size,outputType:e.option.outputType,info:e.option.info,full:e.option.full,canScale:e.option.canScale,canMove:e.option.canMove,canMoveBox:e.option.canMoveBox,original:e.option.original,autoCrop:e.option.autoCrop,autoCropWidth:e.option.autoCropWidth,autoCropHeight:e.option.autoCropHeight,fixedBox:e.option.fixedBox,fixed:e.option.fixed},on:{realTime:e.realTime}})],1)]),e._v(" "),a("el-col",{attrs:{span:11}},[a("div",{staticClass:"croper-right"},[a("div",{staticClass:"preview-box"},[a("div",{staticClass:"preview",style:e.previews.div},[e.corpperImag?a("img",{attrs:{src:e.corpperImag,width:"100%"}}):e._e()])]),e._v(" "),a("input",{staticStyle:{position:"absolute",clip:"rect(0 0 0 0)",width:"1px"},attrs:{type:"file",id:"uploads",accept:"image/png, image/jpeg, image/gif, image/jpg"},domProps:{value:e.imgFile},on:{change:function(t){return e.uploadImg(t,1)}}}),e._v(" "),a("label",{staticClass:"btn",attrs:{for:"uploads"}},[e._v("选择图片")])])])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitUpload}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(m,f,!1,function(e){a("RsQ1")},null,null);t.default=g.exports}});
//# sourceMappingURL=4.a003ed514521161acb6d.js.map