{"version":3,"sources":["webpack:///src/pages/tabpage/syspage/roleList.vue","webpack:///./src/pages/tabpage/syspage/roleList.vue?8ff7","webpack:///./src/pages/tabpage/syspage/roleList.vue"],"names":["roleList","methods","handleClose","init","_this","this","asyncToGenerator_default","regenerator_default","a","mark","_callee","_ref","data","wrap","_context","prev","next","loading","Req","get","api","getAllRole","sent","code","tableData","stop","changeRoleName","row","_this2","dialogVisiblerole","$nextTick","roleValidateForm","checksEdit","flag","_this3","dialogVisible","roleid","role_id","getRoleTreePer","treeMenu","setDisabled","trees","map","it1","disabled","children","dataTree","callback","_this4","_callee2","_ref2","_context2","sysMenutree","_this5","_callee3","_ref3","_context3","$refs","tree","setCheckedKeys","res_id","submit","_this6","_callee4","resIdArr","_ref4","msg","_context4","getCheckedKeys","post","setRoleTreePer","res_idArr","$message","message","type","submitForm","formName","_this7","validate","valid","console","log","isRoleCheck","updateRole","createRole","_this8","_callee5","_ref5","_context5","role_name","role_code","_this9","_callee6","_ref6","_context6","put","deleteRole","_this10","_callee8","_context8","$confirm","confirmButtonText","cancelButtonText","then","_callee7","param","_ref8","_context7","delete","catch","createDialog","resetForm","_this11","resetFields","resIdarr","defaultProps","label","created","syspage_roleList","render","_vm","_h","$createElement","_c","_self","attrs","title","visible","append-to-body","close-on-click-modal","width","on","update:visible","$event","ref","show-checkbox","expand-on-click-node","default-expand-all","accordion","highlight-current","check-strictly","node-key","props","_v","staticClass","slot","click","size","model","label-width","prop","rules","required","autocomplete","value","$$v","$set","expression","icon","directives","name","rawName","staticStyle","border","stripe","fit","align","fixed","scopedSlots","_u","key","fn","scope","effect","staticRenderFns","Component","__webpack_require__","normalizeComponent","__webpack_exports__"],"mappings":"+JA4DAA,GACAC,SACAC,YADA,aAEAC,KAFA,WAEA,IAAAC,EAAAC,KAAA,OAAAC,IAAAC,EAAAC,EAAAC,KAAA,SAAAC,IAAA,IAAAC,EAAAC,EAAA,OAAAL,EAAAC,EAAAK,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACAZ,EAAAa,SAAA,EADAH,EAAAE,KAAA,EAEAZ,EAAAc,IAAAC,IAAAC,EAAA,EAAAC,YAFA,OAAAV,EAAAG,EAAAQ,KAEAV,EAFAD,EAEAC,KACA,MAHAD,EAEAY,OAEAnB,EAAAoB,UAAAZ,EAAAZ,UAEAI,EAAAa,SAAA,EANA,wBAAAH,EAAAW,SAAAf,EAAAN,KAAAE,IAQAoB,eAVA,SAUAC,GAAA,IAAAC,EAAAvB,KACAA,KAAAwB,mBAAA,EACAxB,KAAAyB,UAAA,WACAF,EAAAG,iBAAAJ,KAIAK,WAjBA,SAiBAL,EAAAM,GAAA,IAAAC,EAAA7B,KACAA,KAAA8B,eAAA,EACA9B,KAAA+B,OAAAT,EAAAU,QACAhC,KAAAiC,eAAAjC,KAAA+B,QASA/B,KAAAkC,SAAA,YARA,SAAAC,EAAAC,EAAAR,GACAQ,EAAAC,IAAA,SAAAC,GACAA,EAAAC,SAAAX,EACAU,EAAAE,UACAL,EAAAG,EAAAE,SAAAZ,KAKAO,CAAAN,EAAAY,SAAAb,MAIAM,SAlCA,SAkCAQ,GAAA,IAAAC,EAAA3C,KAAA,OAAAC,IAAAC,EAAAC,EAAAC,KAAA,SAAAwC,IAAA,IAAAC,EAAAtC,EAAA,OAAAL,EAAAC,EAAAK,KAAA,SAAAsC,GAAA,cAAAA,EAAApC,KAAAoC,EAAAnC,MAAA,cAAAmC,EAAAnC,KAAA,EACAgC,EAAA9B,IAAAC,IAAAC,EAAA,EAAAgC,aADA,OAAAF,EAAAC,EAAA7B,KACAV,EADAsC,EACAtC,KACA,MAFAsC,EACA3B,OAEAyB,EAAAF,SAAAlC,EACAmC,KAJA,wBAAAI,EAAA1B,SAAAwB,EAAAD,KAAA1C,IAOAgC,eAzCA,SAyCAF,GAAA,IAAAiB,EAAAhD,KAAA,OAAAC,IAAAC,EAAAC,EAAAC,KAAA,SAAA6C,IAAA,IAAAC,EAAA3C,EAAA,OAAAL,EAAAC,EAAAK,KAAA,SAAA2C,GAAA,cAAAA,EAAAzC,KAAAyC,EAAAxC,MAAA,cAAAwC,EAAAxC,KAAA,EACAqC,EAAAnC,IAAAC,IAAAC,EAAA,EAAAkB,gBAAAD,QAAAD,IADA,OAAAmB,EAAAC,EAAAlC,KACAV,EADA2C,EACA3C,KACA,MAFA2C,EACAhC,MAEA8B,EAAAI,MAAAC,KAAAC,eAAA/C,EAAAgD,QAHA,wBAAAJ,EAAA/B,SAAA6B,EAAAD,KAAA/C,IAOAuD,OAhDA,WAgDA,IAAAC,EAAAzD,KAAA,OAAAC,IAAAC,EAAAC,EAAAC,KAAA,SAAAsD,IAAA,IAAAC,EAAAC,EAAA1C,EAAA2C,EAAA,OAAA3D,EAAAC,EAAAK,KAAA,SAAAsD,GAAA,cAAAA,EAAApD,KAAAoD,EAAAnD,MAAA,cACAgD,EAAAF,EAAAL,MAAAC,KAAAU,iBADAD,EAAAnD,KAAA,EAEA8C,EAAA5C,IAAAmD,KAAAjD,EAAA,EAAAkD,gBAAAC,UAAAP,EAAA3B,QAAAyB,EAAA1B,SAFA,OAAA6B,EAAAE,EAAA7C,KAEAC,EAFA0C,EAEA1C,KAAA2C,EAFAD,EAEAC,IACA,MAAA3C,GACAuC,EAAAU,UACAC,QAAAP,EACAQ,KAAA,YAEAZ,EAAA3B,eAAA,IAEA2B,EAAA3B,eAAA,EACA2B,EAAAU,UACAC,QAAAP,EACAQ,KAAA,aAbA,wBAAAP,EAAA1C,SAAAsC,EAAAD,KAAAxD,IAkBAqE,WAlEA,SAkEAC,GAAA,IAAAC,EAAAxE,KACAA,KAAAoD,MAAAmB,GAAAE,SAAA,SAAAC,GACA,IAAAA,EAQA,OADAC,QAAAC,IAAA,mBACA,EAPAJ,EAAAK,YACAL,EAAAM,aAEAN,EAAAO,gBAQAA,WAhFA,WAgFA,IAAAC,EAAAhF,KAAA,OAAAC,IAAAC,EAAAC,EAAAC,KAAA,SAAA6E,IAAA,IAAAC,EAAAhE,EAAA2C,EAAA,OAAA3D,EAAAC,EAAAK,KAAA,SAAA2E,GAAA,cAAAA,EAAAzE,KAAAyE,EAAAxE,MAAA,cAAAwE,EAAAxE,KAAA,EACAqE,EAAAnE,IAAAmD,KAAAjD,EAAA,EAAAgE,YACAK,UAAAJ,EAAAtD,iBAAA0D,UACAC,UAAAL,EAAAtD,iBAAA2D,YAHA,OAAAH,EAAAC,EAAAlE,KACAC,EADAgE,EACAhE,KAAA2C,EADAqB,EACArB,IAGA,MAAA3C,GACA8D,EAAAlF,OACAkF,EAAAb,UACAC,QAAAP,EACAQ,KAAA,YAEAW,EAAAxD,mBAAA,IAEAwD,EAAAxD,mBAAA,EACAwD,EAAAb,UACAC,QAAAP,EACAQ,KAAA,aAfA,wBAAAc,EAAA/D,SAAA6D,EAAAD,KAAA/E,IAmBA6E,WAnGA,WAmGA,IAAAQ,EAAAtF,KAAA,OAAAC,IAAAC,EAAAC,EAAAC,KAAA,SAAAmF,IAAA,IAAAC,EAAAtE,EAAA2C,EAAA,OAAA3D,EAAAC,EAAAK,KAAA,SAAAiF,GAAA,cAAAA,EAAA/E,KAAA+E,EAAA9E,MAAA,cAAA8E,EAAA9E,KAAA,EACA2E,EAAAzE,IAAA6E,IAAA3E,EAAA,EAAA+D,YACA9C,QAAAsD,EAAA5D,iBAAAM,QACAoD,UAAAE,EAAA5D,iBAAA0D,UACAC,UAAAC,EAAA5D,iBAAA2D,YAJA,OAAAG,EAAAC,EAAAxE,KACAC,EADAsE,EACAtE,KAAA2C,EADA2B,EACA3B,IAIA,MAAA3C,GACAoE,EAAAxF,OACAwF,EAAAnB,UACAC,QAAAP,EACAQ,KAAA,YAEAiB,EAAA9D,mBAAA,IAEA8D,EAAA9D,mBAAA,EACA8D,EAAAnB,UACAC,QAAAP,EACAQ,KAAA,aAhBA,wBAAAoB,EAAArE,SAAAmE,EAAAD,KAAArF,IAoBA0F,WAvHA,SAuHArE,GAAA,IAAAsE,EAAA5F,KAAA,OAAAC,IAAAC,EAAAC,EAAAC,KAAA,SAAAyF,IAAA,OAAA3F,EAAAC,EAAAK,KAAA,SAAAsF,GAAA,cAAAA,EAAApF,KAAAoF,EAAAnF,MAAA,OACAiF,EAAAG,SAAA,2BACAC,kBAAA,KACAC,iBAAA,KACA5B,KAAA,YACA6B,KAJAjG,IAAAC,EAAAC,EAAAC,KAIA,SAAA+F,IAAA,IAAAC,EAAAC,EAAAnF,EAAA2C,EAAA,OAAA3D,EAAAC,EAAAK,KAAA,SAAA8F,GAAA,cAAAA,EAAA5F,KAAA4F,EAAA3F,MAAA,cACAyF,GAAApE,QAAAV,EAAAU,SADAsE,EAAA3F,KAAA,EAEAiF,EAAA/E,IAAA0F,OAAAxF,EAAA,EAAA4E,YAAApF,KAAA6F,IAFA,OAAAC,EAAAC,EAAArF,KAEAC,EAFAmF,EAEAnF,KAAA2C,EAFAwC,EAEAxC,IACA,MAAA3C,IACA0E,EAAA9F,OACA8F,EAAAzB,UACAE,KAAA,UACAD,QAAAP,KAPA,wBAAAyC,EAAAlF,SAAA+E,EAAAP,OAUAY,MAAA,WACAZ,EAAAzB,UACAE,KAAA,OACAD,QAAA,YAlBA,wBAAA0B,EAAA1E,SAAAyE,EAAAD,KAAA3F,IAsBAwG,aA7IA,WA8IAzG,KAAAwB,mBAAA,EACAxB,KAAA6E,aAAA,EACA7E,KAAA0G,UAAA,qBAEAA,UAlJA,SAkJAnC,GAAA,IAAAoC,EAAA3G,KACAA,KAAAyB,UAAA,WACAkF,EAAAvD,MAAAmB,GAAAqC,kBAIArG,KAzJA,WA0JA,OACAuB,eAAA,EACAN,mBAAA,EACAqD,aAAA,EACA1D,aACAsB,YACAoE,YACA9E,OAAA,GACAnB,SAAA,EACAkG,cACAtE,SAAA,WACAuE,MAAA,YAEArF,kBACA0D,UAAA,GACAC,UAAA,GACArD,QAAA,MAIAgF,QA9KA,WA+KAhH,KAAAF,SCtOemH,GADEC,OAJjB,WAA0B,IAAAC,EAAAnH,KAAaoH,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,aAAiCE,OAAOC,MAAA,OAAAC,QAAAP,EAAArF,cAAA6F,iBAAA,GAAAC,wBAAA,EAAAC,MAAA,OAA0GC,IAAKC,iBAAA,SAAAC,GAAkCb,EAAArF,cAAAkG,MAA2BV,EAAA,WAAgBW,IAAA,OAAAT,OAAkBjH,KAAA4G,EAAA1E,SAAAyF,gBAAA,GAAAC,wBAAA,EAAAC,qBAAA,GAAAC,UAAA,GAAAC,oBAAA,GAAAC,iBAAA,GAAAC,WAAA,SAAAC,MAAAtB,EAAAL,gBAAmMK,EAAAuB,GAAA,KAAApB,EAAA,QAAyBqB,YAAA,gBAAAnB,OAAmCoB,KAAA,UAAgBA,KAAA,WAAetB,EAAA,aAAkBQ,IAAIe,MAAA,SAAAb,GAAyBb,EAAArF,eAAA,MAA4BqF,EAAAuB,GAAA,SAAAvB,EAAAuB,GAAA,KAAApB,EAAA,aAA8CE,OAAOsB,KAAA,QAAAzE,KAAA,WAAgCyD,IAAKe,MAAA1B,EAAA3D,UAAoB2D,EAAAuB,GAAA,iBAAAvB,EAAAuB,GAAA,KAAApB,EAAA,aAAsDE,OAAOC,MAAAN,EAAAtC,YAAA,cAAA6C,QAAAP,EAAA3F,kBAAAqG,MAAA,OAAwFC,IAAKC,iBAAA,SAAAC,GAAkCb,EAAA3F,kBAAAwG,MAA+BV,EAAA,WAAgBW,IAAA,mBAAAU,YAAA,gBAAAnB,OAA0DuB,MAAA5B,EAAAzF,iBAAAsH,cAAA,WAAoD1B,EAAA,gBAAqBE,OAAOT,MAAA,MAAAkC,KAAA,YAAAC,QAC9oCC,UAAA,EAAA/E,QAAA,eACAkD,EAAA,YAAiBE,OAAOnD,KAAA,QAAA+E,aAAA,OAAoCL,OAAQM,MAAAlC,EAAAzF,iBAAA,UAAAgB,SAAA,SAAA4G,GAAgEnC,EAAAoC,KAAApC,EAAAzF,iBAAA,YAAA4H,IAAiDE,WAAA,iCAA0C,GAAArC,EAAAuB,GAAA,KAAApB,EAAA,gBAAqCE,OAAOyB,KAAA,YAAAlC,MAAA,UAAmCO,EAAA,YAAiBE,OAAOnD,KAAA,QAAA+E,aAAA,OAAoCL,OAAQM,MAAAlC,EAAAzF,iBAAA,UAAAgB,SAAA,SAAA4G,GAAgEnC,EAAAoC,KAAApC,EAAAzF,iBAAA,YAAA4H,IAAiDE,WAAA,iCAA0C,OAAArC,EAAAuB,GAAA,KAAApB,EAAA,QAAiCqB,YAAA,gBAAAnB,OAAmCoB,KAAA,UAAgBA,KAAA,WAAetB,EAAA,aAAkBE,OAAOnD,KAAA,WAAiByD,IAAKe,MAAA,SAAAb,GAAyB,OAAAb,EAAA7C,WAAA,wBAA4C6C,EAAAuB,GAAA,QAAAvB,EAAAuB,GAAA,KAAApB,EAAA,aAA6CQ,IAAIe,MAAA,SAAAb,GAAyB,OAAAb,EAAAT,UAAA,wBAA2CS,EAAAuB,GAAA,gBAAAvB,EAAAuB,GAAA,KAAApB,EAAA,OAA+CqB,YAAA,YAAsBrB,EAAA,aAAkBE,OAAOsB,KAAA,OAAAW,KAAA,8BAAApF,KAAA,WAAoEyD,IAAKe,MAAA1B,EAAAV,gBAA0BU,EAAAuB,GAAA,YAAAvB,EAAAuB,GAAA,KAAApB,EAAA,YAAgDoC,aAAaC,KAAA,UAAAC,QAAA,YAAAP,MAAAlC,EAAA,QAAAqC,WAAA,YAA4EK,aAAehC,MAAA,QAAeL,OAAQjH,KAAA4G,EAAAhG,UAAA2H,KAAA,QAAAgB,OAAA,GAAAC,OAAA,GAAAC,IAAA,MAAsE1C,EAAA,mBAAwBE,OAAOyC,MAAA,SAAAC,MAAA,GAAAjB,KAAA,UAAAlC,MAAA,OAAAc,MAAA,SAA2EV,EAAAuB,GAAA,KAAApB,EAAA,mBAAoCE,OAAOyC,MAAA,SAAAC,MAAA,GAAAjB,KAAA,YAAAlC,MAAA,UAA+DI,EAAAuB,GAAA,KAAApB,EAAA,mBAAoCE,OAAOyC,MAAA,SAAAhB,KAAA,YAAAlC,MAAA,UAAoDI,EAAAuB,GAAA,KAAApB,EAAA,mBAAoCE,OAAOyC,MAAA,SAAAlD,MAAA,KAAAc,MAAA,MAA2CsC,YAAAhD,EAAAiD,KAAsBC,IAAA,UAAAC,GAAA,SAAAC,GAAiC,OAAAjD,EAAA,aAAwBoC,aAAaC,KAAA,MAAAC,QAAA,QAAAP,MAAA,qBAAAG,WAAA,yBAA0FhC,OAASnD,KAAA,UAAAoF,KAAA,eAAAX,KAAA,OAAA0B,OAAA,QAAqE1C,IAAKe,MAAA,SAAAb,GAAyB,OAAAb,EAAAxF,WAAA4I,EAAAjJ,KAAA,OAAyC6F,EAAAuB,GAAA,UAAAvB,EAAAuB,GAAA,KAAApB,EAAA,aAA+CoC,aAAaC,KAAA,MAAAC,QAAA,QAAAP,MAAA,qBAAAG,WAAA,yBAA0FhC,OAASnD,KAAA,UAAAoF,KAAA,eAAAX,KAAA,OAAA0B,OAAA,QAAqE1C,IAAKe,MAAA,SAAAb,GAAyB,OAAAb,EAAAxF,WAAA4I,EAAAjJ,KAAA,OAA0C6F,EAAAuB,GAAA,UAAAvB,EAAAuB,GAAA,KAAApB,EAAA,aAA+CoC,aAAaC,KAAA,MAAAC,QAAA,QAAAP,MAAA,kBAAAG,WAAA,sBAAoFhC,OAASiC,KAAA,eAAApF,KAAA,UAAAmG,OAAA,OAAA1B,KAAA,QAAqEhB,IAAKe,MAAA,SAAAb,GAAyBb,EAAA9F,eAAAkJ,EAAAjJ,KAAA,GAAA6F,EAAAtC,aAAA,MAA8DsC,EAAAuB,GAAA,QAAAvB,EAAAuB,GAAA,KAAApB,EAAA,aAA6CoC,aAAaC,KAAA,MAAAC,QAAA,QAAAP,MAAA,kBAAAG,WAAA,sBAAoFhC,OAASnD,KAAA,SAAAmG,OAAA,OAAAf,KAAA,iBAAAX,KAAA,QAAsEhB,IAAKe,MAAA,SAAAb,GAAyB,OAAAb,EAAAxB,WAAA4E,EAAAjJ,KAAA,OAA0C6F,EAAAuB,GAAA,gBAAsB,QAEh4F+B,oBCUjBC,EAdyBC,EAAQ,OAcjCC,CACEjL,EACAsH,GATF,EAEA,KAEA,KAEA,MAUe4D,EAAA,QAAAH,EAAiB","file":"static/js/7.26fa8ee2968234b1b958.js","sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog  title=\"菜单权限\" :visible.sync=\"dialogVisible\" append-to-body :close-on-click-modal=\"false\"  width=\"15%\">\r\n      <el-tree\r\n        :data=\"dataTree\"\r\n        show-checkbox\r\n        :expand-on-click-node=\"true\"\r\n        default-expand-all\r\n        accordion highlight-current\r\n        check-strictly\r\n        node-key=\"res_id\"\r\n        ref=\"tree\"\r\n        :props=\"defaultProps\">\r\n      </el-tree>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n        <el-button size=\"small\"  type=\"primary\" @click=\"submit\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n\r\n    <el-dialog :title=\"isRoleCheck ? '编辑角色' : '新增角色'\"  :visible.sync=\"dialogVisiblerole\" width=\"25%\" >\r\n      <el-form :model=\"roleValidateForm\" ref=\"roleValidateForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n          <el-form-item\r\n            label=\"角色名\"\r\n            prop=\"role_name\"\r\n            :rules=\"[\r\n              { required: true, message: '角色名不能为空'}\r\n            ]\"\r\n          >\r\n            <el-input type=\"input\" v-model=\"roleValidateForm.role_name\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item  prop=\"role_code\"   label=\"角色编码\">\r\n              <el-input type=\"input\" v-model=\"roleValidateForm.role_code\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"submitForm('roleValidateForm')\">提交</el-button>\r\n        <el-button @click=\"resetForm('roleValidateForm')\">重置</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <div class=\"btn-box\">\r\n      <el-button size=\"mini\" icon=\"el-icon-circle-plus-outline\" type=\"primary\" @click=\"createDialog\">新建</el-button>\r\n    </div>\r\n    <el-table :data=\"tableData\" v-loading=\"loading\"  size=\"small\"  border  stripe  fit   style=\"width: 100%\">\r\n      <el-table-column      align=\"center\"  fixed   prop=\"role_id\"  label=\"角色ID\"    width=\"150\"></el-table-column>\r\n      <el-table-column      align=\"center\"  fixed   prop=\"role_code\" label=\"角色编码\"></el-table-column>\r\n      <el-table-column      align=\"center\"  prop=\"role_name\"      label=\"角色名称\" ></el-table-column>\r\n      <el-table-column       align=\"center\" label=\"操作\"     width=\"00\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button v-has=\"'sys:role:lookPerms'\" @click=\"checksEdit(scope.row, true)\" type=\"primary\" icon=\"el-icon-view\" size=\"mini\" effect=\"dark\">查看权限</el-button>\r\n            <el-button v-has=\"'sys:role:editPerms'\" @click=\"checksEdit(scope.row, false)\" type=\"warning\" icon=\"el-icon-edit\" size=\"mini\" effect=\"dark\">编辑权限</el-button>\r\n            <el-button v-has=\"'sys:role:update'\" @click=\"changeRoleName(scope.row, false),isRoleCheck = true\"  icon=\"el-icon-edit\" type=\"primary\" effect=\"dark\" size=\"mini\">修改</el-button>\r\n            <el-button v-has=\"'sys:role:delete'\" @click=\"deleteRole(scope.row, false)\" type=\"danger\" effect=\"dark\" icon=\"el-icon-delete\" size=\"mini\">删除</el-button>\r\n         </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { api } from '@/request/api.js'\r\nexport default {\r\n  methods: {\r\n    handleClose () {},\r\n    async init () {\r\n      this.loading = true\r\n      let { data, code } = await this.Req.get(api.getAllRole)\r\n      if (code === 200) {\r\n        this.tableData = data.roleList\r\n      }\r\n      this.loading = false\r\n    },\r\n    changeRoleName (row) {\r\n      this.dialogVisiblerole = true\r\n      this.$nextTick(() => { // 确保dom渲染玩再做赋值处理不然当重置表单会有问题\r\n        this.roleValidateForm = row\r\n      })\r\n    },\r\n    // 查看编辑权限\r\n    checksEdit (row, flag) {\r\n      this.dialogVisible = true\r\n      this.roleid = row.role_id\r\n      this.getRoleTreePer(this.roleid)\r\n      function setDisabled (trees, flag) {\r\n        trees.map((it1) => {\r\n          it1.disabled = flag\r\n          if (it1.children) {\r\n            setDisabled(it1.children, flag)\r\n          }\r\n        })\r\n      }\r\n      this.treeMenu(() => { // 当树加载完毕再修改disabled属性\r\n        setDisabled(this.dataTree, flag)\r\n      })\r\n    },\r\n    // 获取菜单树\r\n    async treeMenu (callback) {\r\n      let { data, code } = await this.Req.get(api.sysMenutree)\r\n      if (code === 200) {\r\n        this.dataTree = data\r\n        callback()\r\n      }\r\n    },\r\n    async getRoleTreePer (roleid) {\r\n      let { data, code } = await this.Req.get(api.getRoleTreePer, { role_id: roleid })\r\n      if (code === 200) {\r\n        this.$refs.tree.setCheckedKeys(data.res_id)\r\n      }\r\n    },\r\n    // 修改权限\r\n    async submit () {\r\n      let resIdArr = this.$refs.tree.getCheckedKeys()\r\n      let { code, msg } = await this.Req.post(api.setRoleTreePer, {res_idArr: resIdArr, role_id: this.roleid})\r\n      if (code === 200) {\r\n        this.$message({\r\n          message: msg,\r\n          type: 'success'\r\n        })\r\n        this.dialogVisible = false\r\n      } else {\r\n        this.dialogVisible = false\r\n        this.$message({\r\n          message: msg,\r\n          type: 'success'\r\n        })\r\n      }\r\n    },\r\n    // 编辑创建\r\n    submitForm (formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          if (this.isRoleCheck) {\r\n            this.updateRole()\r\n          } else {\r\n            this.createRole()\r\n          }\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    async createRole () {\r\n      let { code, msg } = await this.Req.post(api.createRole, {\r\n        role_name: this.roleValidateForm.role_name,\r\n        role_code: this.roleValidateForm.role_code })\r\n      if (code === 200) {\r\n        this.init()\r\n        this.$message({\r\n          message: msg,\r\n          type: 'success'\r\n        })\r\n        this.dialogVisiblerole = false\r\n      } else {\r\n        this.dialogVisiblerole = false\r\n        this.$message({\r\n          message: msg,\r\n          type: 'success'\r\n        })\r\n      }\r\n    },\r\n    async updateRole () {\r\n      let { code, msg } = await this.Req.put(api.updateRole, {\r\n        role_id: this.roleValidateForm.role_id,\r\n        role_name: this.roleValidateForm.role_name,\r\n        role_code: this.roleValidateForm.role_code })\r\n      if (code === 200) {\r\n        this.init()\r\n        this.$message({\r\n          message: msg,\r\n          type: 'success'\r\n        })\r\n        this.dialogVisiblerole = false\r\n      } else {\r\n        this.dialogVisiblerole = false\r\n        this.$message({\r\n          message: msg,\r\n          type: 'success'\r\n        })\r\n      }\r\n    },\r\n    async deleteRole (row) {\r\n      this.$confirm('此操作将永久删除该角色, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        let param = { role_id: row.role_id }\r\n        let { code, msg } = await this.Req.delete(api.deleteRole, {data: param})\r\n        if (code === 200) {\r\n          this.init()\r\n          this.$message({\r\n            type: 'success',\r\n            message: msg\r\n          })\r\n        }\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        })\r\n      })\r\n    },\r\n    createDialog () {\r\n      this.dialogVisiblerole = true\r\n      this.isRoleCheck = false\r\n      this.resetForm('roleValidateForm')\r\n    },\r\n    resetForm (formName) {\r\n      this.$nextTick(() => {\r\n        this.$refs[formName].resetFields()\r\n      })\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      dialogVisible: false,\r\n      dialogVisiblerole: false,\r\n      isRoleCheck: false,\r\n      tableData: [],\r\n      dataTree: [],\r\n      resIdarr: [],\r\n      roleid: '',\r\n      loading: false,\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'res_name'\r\n      },\r\n      roleValidateForm: {\r\n        role_name: '',\r\n        role_code: '',\r\n        role_id: ''\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    this.init()\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/tabpage/syspage/roleList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-dialog',{attrs:{\"title\":\"菜单权限\",\"visible\":_vm.dialogVisible,\"append-to-body\":\"\",\"close-on-click-modal\":false,\"width\":\"15%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.dataTree,\"show-checkbox\":\"\",\"expand-on-click-node\":true,\"default-expand-all\":\"\",\"accordion\":\"\",\"highlight-current\":\"\",\"check-strictly\":\"\",\"node-key\":\"res_id\",\"props\":_vm.defaultProps}}),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.submit}},[_vm._v(\"确 定\")])],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.isRoleCheck ? '编辑角色' : '新增角色',\"visible\":_vm.dialogVisiblerole,\"width\":\"25%\"},on:{\"update:visible\":function($event){_vm.dialogVisiblerole=$event}}},[_c('el-form',{ref:\"roleValidateForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.roleValidateForm,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"角色名\",\"prop\":\"role_name\",\"rules\":[\n            { required: true, message: '角色名不能为空'}\n          ]}},[_c('el-input',{attrs:{\"type\":\"input\",\"autocomplete\":\"off\"},model:{value:(_vm.roleValidateForm.role_name),callback:function ($$v) {_vm.$set(_vm.roleValidateForm, \"role_name\", $$v)},expression:\"roleValidateForm.role_name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"prop\":\"role_code\",\"label\":\"角色编码\"}},[_c('el-input',{attrs:{\"type\":\"input\",\"autocomplete\":\"off\"},model:{value:(_vm.roleValidateForm.role_code),callback:function ($$v) {_vm.$set(_vm.roleValidateForm, \"role_code\", $$v)},expression:\"roleValidateForm.role_code\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('roleValidateForm')}}},[_vm._v(\"提交\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){return _vm.resetForm('roleValidateForm')}}},[_vm._v(\"重置\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"btn-box\"},[_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-circle-plus-outline\",\"type\":\"primary\"},on:{\"click\":_vm.createDialog}},[_vm._v(\"新建\")])],1),_vm._v(\" \"),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData,\"size\":\"small\",\"border\":\"\",\"stripe\":\"\",\"fit\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"prop\":\"role_id\",\"label\":\"角色ID\",\"width\":\"150\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"prop\":\"role_code\",\"label\":\"角色编码\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"role_name\",\"label\":\"角色名称\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"操作\",\"width\":\"00\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{directives:[{name:\"has\",rawName:\"v-has\",value:('sys:role:lookPerms'),expression:\"'sys:role:lookPerms'\"}],attrs:{\"type\":\"primary\",\"icon\":\"el-icon-view\",\"size\":\"mini\",\"effect\":\"dark\"},on:{\"click\":function($event){return _vm.checksEdit(scope.row, true)}}},[_vm._v(\"查看权限\")]),_vm._v(\" \"),_c('el-button',{directives:[{name:\"has\",rawName:\"v-has\",value:('sys:role:editPerms'),expression:\"'sys:role:editPerms'\"}],attrs:{\"type\":\"warning\",\"icon\":\"el-icon-edit\",\"size\":\"mini\",\"effect\":\"dark\"},on:{\"click\":function($event){return _vm.checksEdit(scope.row, false)}}},[_vm._v(\"编辑权限\")]),_vm._v(\" \"),_c('el-button',{directives:[{name:\"has\",rawName:\"v-has\",value:('sys:role:update'),expression:\"'sys:role:update'\"}],attrs:{\"icon\":\"el-icon-edit\",\"type\":\"primary\",\"effect\":\"dark\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.changeRoleName(scope.row, false),_vm.isRoleCheck = true}}},[_vm._v(\"修改\")]),_vm._v(\" \"),_c('el-button',{directives:[{name:\"has\",rawName:\"v-has\",value:('sys:role:delete'),expression:\"'sys:role:delete'\"}],attrs:{\"type\":\"danger\",\"effect\":\"dark\",\"icon\":\"el-icon-delete\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.deleteRole(scope.row, false)}}},[_vm._v(\"删除\")])]}}])})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3ff9b258\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/tabpage/syspage/roleList.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./roleList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./roleList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3ff9b258\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./roleList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/tabpage/syspage/roleList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}